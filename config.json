Improve performance [Yw6mWx] line 2.2
Add test case for W [co6OZe] line 3.1
